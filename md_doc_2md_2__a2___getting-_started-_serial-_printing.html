<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libDaisy: Getting Started - Serial Printing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" type="image/x-icon" href="ES_Circle_Orange.PNG">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html"><img alt="Logo" src="DaisyLogo.png"/></a>
  </td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libDaisy
   </div>
   <div id="projectbrief">Hardware Library for Daisy</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_doc_2md_2__a2___getting-_started-_serial-_printing.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Getting Started - Serial Printing</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md12"></a> One of the most effective ways of debugging your software without having to add additional hardware is to be able to print information from your source code.</p>
<p>In a normal C/C++ program you might use <code>printf</code> or <code>std::cout</code>, these can be set up to work on the Daisy to print over JTAG, but without any extra hardware we can log information out through the built-in USB port on the Daisy.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Choosing a Serial Monitor</h1>
<p>Your first question might be, "How can I see where it's printing on my computer?" And there are a ton of answers to this question.</p>
<p>The offerings for Serial Monitors vary from OS to OS, but there are a few options that are cross platform, and <em>just work</em>:</p>
<ul>
<li>Arduino - has a built in Serial Monitor that works great with Daisy.</li>
<li>Serial Port Helper extension for VS Code is simple to use, and works great with Daisy.</li>
</ul>
<p>(If you're using the Serial Port Helper extension you'll have to the "view" option from "hex" to "string" the first time you connect to the COM port.)</p>
<p>There are a number of other options out there, and if you've already used a different tool with success, feel free to keep using it!</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Hello World</h1>
<p>A simple "Hello World", might look a little something like:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="daisy__seed_8h.html">daisy_seed.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedaisy.html">daisy</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_daisy_seed.html">DaisySeed</a> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">main</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize the Daisy Seed Hardware</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.<a class="code hl_function" href="classdaisy_1_1_led_driver_pca9685.html#a468206d813cff0033a50e7ce613ad8cb">Init</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enable Logging, and set up the USB connection.</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.StartLog();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// And Print Hello World!</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;Hello World!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span>(1) {}</div>
<div class="line">}</div>
<div class="ttc" id="aclassdaisy_1_1_daisy_seed_html"><div class="ttname"><a href="classdaisy_1_1_daisy_seed.html">daisy::DaisySeed</a></div><div class="ttdoc">This is the higher-level interface for the Daisy board.   All basic peripheral configuration/initiali...</div><div class="ttdef"><b>Definition</b> daisy_seed.h:19</div></div>
<div class="ttc" id="aclassdaisy_1_1_led_driver_pca9685_html"><div class="ttname"><a href="classdaisy_1_1_led_driver_pca9685.html">daisy::LedDriverPca9685</a></div><div class="ttdef"><b>Definition</b> leddriver.h:33</div></div>
<div class="ttc" id="aclassdaisy_1_1_led_driver_pca9685_html_a468206d813cff0033a50e7ce613ad8cb"><div class="ttname"><a href="classdaisy_1_1_led_driver_pca9685.html#a468206d813cff0033a50e7ce613ad8cb">daisy::LedDriverPca9685::Init</a></div><div class="ttdeci">void Init(I2CHandle i2c, const uint8_t(&amp;addresses)[numDrivers], DmaBuffer dma_buffer_a, DmaBuffer dma_buffer_b, dsy_gpio_pin oe_pin={DSY_GPIOX, 0})</div><div class="ttdef"><b>Definition</b> leddriver.h:65</div></div>
<div class="ttc" id="adaisy__seed_8h_html"><div class="ttname"><a href="daisy__seed_8h.html">daisy_seed.h</a></div></div>
<div class="ttc" id="anamespacedaisy_html"><div class="ttname"><a href="namespacedaisy.html">daisy</a></div><div class="ttdoc">Hardware defines and helpers for daisy field platform.</div><div class="ttdef"><b>Definition</b> index.h:2</div></div>
</div><!-- fragment --><p>Chances are, if you tried to run this code, you might have missed the "Hello World" since it happens almost instantly after the program starts. It probably happened before you could connect to the Serial Port.</p>
<p>There are are a few ways to address this issue, and we'll look at both:</p>
<p>First, you could add a large delay between the Start Log, and the first thing you want to print:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.StartLog();</div>
<div class="line">System::Delay(5000);</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;Hello World!&quot;</span>);</div>
</div><!-- fragment --><p>This works, but you still only have 5 seconds to connect to the port before you might end up missing the message.</p>
<p>Another solution would be to move the PrintLine into the infinite while loop.</p>
<div class="fragment"><div class="line">. . .</div>
<div class="line">hw.StartLog();</div>
<div class="line"><span class="keywordflow">while</span>(1) {</div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;Hello World!&quot;</span>);</div>
<div class="line">  System::Delay(1000); <span class="comment">// Wait 1 second between printing</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>This works, but if you only want to print something once, or you're debugging something in your initialziation code, then it's not very useful to continuously print it over and over again.</p>
<p>So what's the best solution? Well, there's an optional argument for the Logger that will wait for connection to the COM port before resuming code execution.</p>
<p>By calling:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.StartLog(<span class="keyword">true</span>);</div>
</div><!-- fragment --><p>The program will wait indefinitely until you connect before moving on.</p>
<p>So, for our best Hello World, where it's impossible to miss the message on the Serial Monitor:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="daisy__seed_8h.html">daisy_seed.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedaisy.html">daisy</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_daisy_seed.html">DaisySeed</a> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">main</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize the Daisy Seed Hardware</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.<a class="code hl_function" href="classdaisy_1_1_led_driver_pca9685.html#a468206d813cff0033a50e7ce613ad8cb">Init</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enable Logging, and set up the USB connection.</span></div>
<div class="line">  <span class="comment">// Setting true here means that the program will wait until</span></div>
<div class="line">  <span class="comment">// a connection has been made to a USB Host</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.StartLog(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// And Print Hello World!</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;Hello World!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span>(1) {}</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now, there are times where this is exactly what we want, and there's times where we want our board to run with, or without the USB connected. In the latter case, we will instead choose one of the other potential solutions, or create special cases for DEBUG builds vs RELEASE builds.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
String Formatting</h1>
<p>For those of you used to format specifiers from C or C++, you will feel right at home as the <code>Print</code> and <code>PrintLine</code> functions both use the same syntax.</p>
<p>For those unfamiliar, you can find information on the specifiers in the <a href="https://en.cppreference.com/w/cpp/io/c/fprintf">cpp language documentation</a>.</p>
<p>For example, consider counting something:</p>
<div class="fragment"><div class="line">. . .</div>
<div class="line"><span class="comment">// Declare an int set to 0</span></div>
<div class="line">int <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">mycnt</a> = 0;</div>
<div class="line"><span class="keywordflow">while</span>(1) {</div>
<div class="line">  <span class="comment">// Print the value:</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;Count: %d&quot;</span>, <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">mycnt</a>);</div>
<div class="line">  <span class="comment">// And then increment the counter</span></div>
<div class="line">  <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">mycnt</a>++;</div>
<div class="line">  <span class="comment">// If the counter exceeds 100, reset it to 0</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">mycnt</a> &gt; 100)</div>
<div class="line">    <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">mycnt</a> = 0;</div>
<div class="line">  <span class="comment">// And count slow enough that it&#39;s easy to watch on the Serial Monitor</span></div>
<div class="line">  System::Delay(250);</div>
<div class="line">}</div>
</div><!-- fragment --><p>This example will output:</p>
<div class="fragment"><div class="line">Count: 0</div>
<div class="line">Count: 1</div>
<div class="line">Count: 2</div>
</div><!-- fragment --><p>and so on all the way up to 100 before repeating itself.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Floating Point Numbers</h1>
<p>Due to the small memory footprint of an embedded platform like daisy, floating point numbers are handled slightly differently by default, and won't work with the <code>f</code> format specifier.</p>
<p>Each of the following options has its own benefits:</p>
<ul>
<li>Adding the <code>LDFLAG</code> for <code>f</code> support: For ease-of-use, when memory limits are not an issue.</li>
<li>Using the <code>FLT_FMT</code>, <code>FLT_VAR</code> specifiers: For minimal cost, drop in for printing the ocassional float.</li>
<li>FixedCapStr: When you know the size of the strings, building UIs, etc.</li>
</ul>
<h2><a class="anchor" id="autotoc_md17"></a>
Using %f specifier</h2>
<p>That said, if you really want to be able to use the <code>f</code>, and your application isn't nearing the maximum size, you can add the following to your project's application Makefile:</p>
<div class="fragment"><div class="line">LDFLAGS += -u _printf_float</div>
</div><!-- fragment --><p>This does add a few kilobytes to the flash usage of any program, and is why it's not included by default.</p>
<p>With that flag added you can print floats as you would expect:</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">my_flt</a> = 123.456f;</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;My Float: %f&quot;</span>, <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">my_flt</a>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
Using FLT_FMT and FLT_VAR macros</h2>
<p>Without the extra memory cost of adding that linker flag, there are a few other ways to output floating point numbers:</p>
<p>One is to use special macros provided with the Logger class:</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">my_flt</a> = 123.456f;</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;My Float: &quot;</span> <a class="code hl_define" href="group__logging__macros.html#gaa7cc11426d24168f3430b4b070291e7c">FLT_FMT3</a>, <a class="code hl_define" href="group__logging__macros.html#ga5aa9dc2e89ac7abbcaaffca896ce8d7c">FLT_VAR3</a>(<a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">my_flt</a>));</div>
<div class="ttc" id="agroup__logging__macros_html_ga5aa9dc2e89ac7abbcaaffca896ce8d7c"><div class="ttname"><a href="group__logging__macros.html#ga5aa9dc2e89ac7abbcaaffca896ce8d7c">FLT_VAR3</a></div><div class="ttdeci">#define FLT_VAR3(_x)</div><div class="ttdef"><b>Definition</b> logger.h:58</div></div>
<div class="ttc" id="agroup__logging__macros_html_gaa7cc11426d24168f3430b4b070291e7c"><div class="ttname"><a href="group__logging__macros.html#gaa7cc11426d24168f3430b4b070291e7c">FLT_FMT3</a></div><div class="ttdeci">#define FLT_FMT3</div><div class="ttdef"><b>Definition</b> logger.h:55</div></div>
</div><!-- fragment --><p>To specify more or less decimal places you can use the more generic macros</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">more_precice_float</a> = 123.456789f;</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<span class="stringliteral">&quot;My Float: &quot;</span> <a class="code hl_define" href="group__logging__macros.html#ga3817e299d9635796e3fd69adaa0d6823">FLT_FMT</a>(6), <a class="code hl_define" href="group__logging__macros.html#gad4da30407c6778ebdea4c0002df9daab">FLT_VAR</a>(6, <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">my_flt</a>));</div>
<div class="ttc" id="agroup__logging__macros_html_ga3817e299d9635796e3fd69adaa0d6823"><div class="ttname"><a href="group__logging__macros.html#ga3817e299d9635796e3fd69adaa0d6823">FLT_FMT</a></div><div class="ttdeci">#define FLT_FMT(_n)</div><div class="ttdef"><b>Definition</b> logger.h:43</div></div>
<div class="ttc" id="agroup__logging__macros_html_gad4da30407c6778ebdea4c0002df9daab"><div class="ttname"><a href="group__logging__macros.html#gad4da30407c6778ebdea4c0002df9daab">FLT_VAR</a></div><div class="ttdeci">#define FLT_VAR(_n, _x)</div><div class="ttdef"><b>Definition</b> logger.h:49</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Using FixedCapStr class</h2>
<p>Another way is to use the <code>FixedCapStr</code> class, and the <code>appendFloat</code> function:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">FixedCapStr&lt;16&gt;</a> <a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">str</a>(<span class="stringliteral">&quot;Value: &quot;</span>);</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">str</a>.AppendFloat(123.456f);</div>
<div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">hw</a>.PrintLine(<a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">str</a>);</div>
</div><!-- fragment --><p>You'll notice that the default for the <code>AppendFloat</code> function is to round to the nearest two decimal places. You can adjust this to print more decimal places by adding a second argument:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classdaisy_1_1_led_driver_pca9685.html">str</a>.AppendFloat(123.456f, 3);</div>
</div><!-- fragment --><p>This last option has a lot of flexibility for other types, and works well when building complex user interfaces with Displays, and the <code>Ui</code> class. You do have to be mindful that the template argument is large enough for the final string you want to make.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Further Reading</h1>
<p>Topics without links are coming soon:</p>
<ul>
<li>Reading and Writing to SD Cards and USB Drives</li>
<li><a class="el" href="md_doc_2md_2__a4___getting-_started-_a_d_cs.html">Working with ADCs</a></li>
<li>Building UIs for Displays </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <!-- id is needed for treeview function! -->
  <ul>
  </ul>
</div>
<script type="text/javascript">
  // script for doxygen 1.9.2
  $(function () {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function () {
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    $(window).resize(function () {
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>