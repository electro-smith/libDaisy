<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libDaisy: daisy::I2CHandle Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libDaisy
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedaisy.html">daisy</a></li><li class="navelem"><a class="el" href="classdaisy_1_1_i2_c_handle.html">I2CHandle</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classdaisy_1_1_i2_c_handle-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">daisy::I2CHandle Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="per__i2c_8h_source.html">per_i2c.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdaisy_1_1_i2_c_handle_1_1_config.html">Config</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a4896eede457dea6ed2ed68d9b06e8e16"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> { <a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16ae0aa021e21dddbd6d8cecec71e9cf564">Result::OK</a>, 
<a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16acd22bad976363fdd1bfbf6759fede482">Result::ERR</a>
 }</td></tr>
<tr class="separator:a4896eede457dea6ed2ed68d9b06e8e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865f3f2c45b937c4084081f807e15d7b"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a865f3f2c45b937c4084081f807e15d7b">CallbackFunctionPtr</a>) (void *context, <a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> result)</td></tr>
<tr class="separator:a865f3f2c45b937c4084081f807e15d7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2185e1025f9fd194e8a8979aa875810b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2185e1025f9fd194e8a8979aa875810b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>I2CHandle</b> (const <a class="el" href="classdaisy_1_1_i2_c_handle.html">I2CHandle</a> &amp;other)=default</td></tr>
<tr class="separator:a2185e1025f9fd194e8a8979aa875810b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c70b107e92e84682dca7c7087f2f504"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c70b107e92e84682dca7c7087f2f504"></a>
<a class="el" href="classdaisy_1_1_i2_c_handle.html">I2CHandle</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classdaisy_1_1_i2_c_handle.html">I2CHandle</a> &amp;other)=default</td></tr>
<tr class="separator:a1c70b107e92e84682dca7c7087f2f504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3010881bcac1d32f6f974edc9bbc6c0d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a3010881bcac1d32f6f974edc9bbc6c0d">Init</a> (const <a class="el" href="structdaisy_1_1_i2_c_handle_1_1_config.html">Config</a> &amp;config)</td></tr>
<tr class="separator:a3010881bcac1d32f6f974edc9bbc6c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b183cb21c4ab4c0c005e6d33eac059b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structdaisy_1_1_i2_c_handle_1_1_config.html">Config</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4b183cb21c4ab4c0c005e6d33eac059b">GetConfig</a> () const </td></tr>
<tr class="separator:a4b183cb21c4ab4c0c005e6d33eac059b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf279a20fe8338672cbfa7f3e0e720ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#acf279a20fe8338672cbfa7f3e0e720ae">TransmitBlocking</a> (uint16_t address, uint8_t *data, uint16_t size, uint32_t timeout)</td></tr>
<tr class="separator:acf279a20fe8338672cbfa7f3e0e720ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2def35901e936c7c7c88aef8e1633f14"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a2def35901e936c7c7c88aef8e1633f14">TransmitDma</a> (uint16_t address, uint8_t *data, uint16_t size, <a class="el" href="classdaisy_1_1_i2_c_handle.html#a865f3f2c45b937c4084081f807e15d7b">CallbackFunctionPtr</a> callback, void *callback_context)</td></tr>
<tr class="separator:a2def35901e936c7c7c88aef8e1633f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A handle for interacting with an I2C peripheral. This is a dumb gateway that internally points to one of the four I2C peripherals after it was initialised. It can then be copied and passed around. Use an <a class="el" href="classdaisy_1_1_i2_c_handle.html">I2CHandle</a> like this: </p><pre class="fragment">// setup the configuration
I2CHandle::Config i2c_conf;
i2c_conf.periph = I2CHandle::Config::Peripheral::I2C1;
i2c_conf.speed  = I2CHandle::Config::Speed::I2C_400KHZ;
i2c_conf.pin_config.scl  = {DSY_GPIOB, 8};
i2c_conf.pin_config.sda  = {DSY_GPIOB, 9};
// initialise the peripheral
I2CHandle i2c;
i2c.Init(i2c_conf);
// now i2c points to the corresponding peripheral and can be used.
i2c.TransmitBlocking( ... );</pre> </div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a865f3f2c45b937c4084081f807e15d7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* daisy::I2CHandle::CallbackFunctionPtr) (void *context, <a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> result)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A callback to be executed when a dma transfer is complete. </p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a4896eede457dea6ed2ed68d9b06e8e16"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">daisy::I2CHandle::Result</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return values for I2C functions. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a4896eede457dea6ed2ed68d9b06e8e16ae0aa021e21dddbd6d8cecec71e9cf564"></a>OK&#160;</td><td class="fielddoc">
<p>&amp; </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a4896eede457dea6ed2ed68d9b06e8e16acd22bad976363fdd1bfbf6759fede482"></a>ERR&#160;</td><td class="fielddoc">
<p>&amp; </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4b183cb21c4ab4c0c005e6d33eac059b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structdaisy_1_1_i2_c_handle_1_1_config.html">Config</a>&amp; daisy::I2CHandle::GetConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the current config. </p>

</div>
</div>
<a class="anchor" id="a3010881bcac1d32f6f974edc9bbc6c0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> daisy::I2CHandle::Init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdaisy_1_1_i2_c_handle_1_1_config.html">Config</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes an I2C peripheral. </p>

</div>
</div>
<a class="anchor" id="acf279a20fe8338672cbfa7f3e0e720ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> daisy::I2CHandle::TransmitBlocking </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transmits data and blocks until the transmission is complete. Use this for smaller transmissions of a few bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>The slave device address. </td></tr>
    <tr><td class="paramname">data</td><td>A pointer to the data to be sent. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the data to be sent, in bytes. </td></tr>
    <tr><td class="paramname">timeout</td><td>A timeout. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2def35901e936c7c7c88aef8e1633f14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a4896eede457dea6ed2ed68d9b06e8e16">Result</a> daisy::I2CHandle::TransmitDma </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdaisy_1_1_i2_c_handle.html#a865f3f2c45b937c4084081f807e15d7b">CallbackFunctionPtr</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>callback_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transmits data with a DMA and returns immediately. Use this for larger transmissions. The pointer to data must be located in the D2 memory domain by adding the <code>DMA_BUFFER_MEM_SECTION</code> attribute like this: uint8_t DMA_BUFFER_MEM_SECTION my_buffer[100]; If that is not possible for some reason, you MUST clear the cachelines spanning the size of the buffer, before initiating the dma transfer by calling <code>dsy_dma_clear_cache_for_buffer(buffer, size);</code></p>
<p>A single DMA is shared across I2C, I2C2 and I2C3. I2C4 has no DMA support (yet). If the DMA is busy with another transfer, the job will be queued and executed later. If there is a job waiting to be executed for this I2C peripheral, this function will block until the queue is free and the job can be queued.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>The slave device address. </td></tr>
    <tr><td class="paramname">data</td><td>A pointer to the data to be sent. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the data to be sent, in bytes. </td></tr>
    <tr><td class="paramname">callback</td><td>A callback to execute when the transfer finishes, or NULL. </td></tr>
    <tr><td class="paramname">callback_context</td><td>A pointer that will be passed back to you in the callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/<a class="el" href="per__i2c_8h_source.html">per_i2c.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
